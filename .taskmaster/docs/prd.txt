# 製品要求仕様書（PRD）: キャラクターフィードバック日記アプリ

## 1. プロジェクト概要

本プロジェクトは、ユーザーが書いた日記に対して、個性豊かなキャラクターたちがフィードバックをくれる新しい形のWeb日記アプリを開発します。日々の出来事を記録するだけでなく、キャラクターとの対話を通じて、ユーザーが日記の習慣を楽しく継続できること、そして新たな気づきや自己理解を深めるきっかけを提供することを目的とします。

## 2. プロジェクトのゴール

- ユーザーが日記の執筆を習慣化できるような、楽しく魅力的な体験を提供する。
- キャラクターからの多角的なフィードバックにより、ユーザーの自己理解を促進する。
- キャラクターとの継続的な対話（チャット）を通じて、ユーザーのエンゲージメントを高める。

## 3. ユーザー体験（UX）

- ユーザーは1日に複数回、自由なタイミングで日記を書き込むことができる。
- 翌日の朝4時になると、日記の内容に基づいたキャラクターからのフィードバックが届き、新しい一日を新鮮な気持ちで始められる。

## 4. 機能要件

### 4.1. ユーザー認証機能
- ユーザーアカウントを作成し、ログイン・ログアウトできる。
- Supabase Authを利用して、安全にユーザー情報を管理する。

### 4.2. 日記機能
- **作成:** 日記のエントリーを新規作成・保存する。
- **閲覧:** 過去の日記をリスト形式およびカレンダー形式で閲覧できる。
- **検索:** 日記の内容をキーワードで検索できる。

### 4.3. キャラクター機能
- 以下の8体の個性的なキャラクターが登場する。
    - **鈴木 ハジメ (ライフコーチ):** 論理的かつポジティブな視点から、ユーザーの成長を促すアドバイスをくれる。
    - **星野 推子 (推し活女子):** 共感力が高く、常にユーザーの「推し」を見つけて全力で応援してくれる。
    - **スマイリー中村 (お笑い芸人):** 関西弁で、どんな出来事もユーモアを交えて笑いに変え、元気づけてくれる。
    - **カズママ (2丁目ママ):** 人生経験豊富。酸いも甘いも知る立場から、時に厳しくも愛のある言葉をくれる。
    - **さとり和尚 (お坊さん):** 仏教的な視点から、物事の本質を突き、心を穏やかにする教えを説く。
    - **本田 栞 (読書家少女):** 物語の登場人物や名言を引用しながら、文学的な表現でフィードバックをくれる。
    - **織田 ノブ (戦国武将):** 天下統一を目指すかのような力強い言葉で、ユーザーの行動を鼓舞する。
    - **ミーコ (猫):** 猫ならではの自由気ままで飾らない視点から、シンプルな癒やしを与えてくれる。
- Playwrightを利用して「Yahoo!ニュース」から時事ネタを取得し、コメントに反映させる。

### 4.4. フィードバック機能
- **生成:** 毎日朝4時に、前日までの日記、過去のフィードバック、チャット履歴をコンテキストとして、ChatGPT APIを用いてフィードバックを生成する。
- **コンテキスト管理:** 長期的な対話を実現するため、過去のやり取りを適宜要約し、AIのコンテキスト長制限に対応する。
- **お気に入り:** 気に入ったフィードバックを保存し、マイページからいつでも見返すことができる。

### 4.5. チャット機能
- 各キャラクターと個別に対話できるチャット画面を提供する。
- 過去の会話履歴をコンテキストとして、自然な対話を実現する。

### 4.6. UI/UX
- **フッターナビゲーション:** 「日記を書く」「一覧」「フィードバック」「マイページ」の4つの主要タブを配置。
- **日記タブ:** シンプルで直感的な日記入力インターフェース。
- **一覧タブ:** 日記の一覧表示、カレンダー表示、キーワード検索機能を提供。
- **フィードバックタブ:**
    - キャラクターの顔画像と名前、フィードバックの一部が書かれたカードを一覧表示。
    - カードをタップすると、フィードバックの全文とチャットへの導線を表示。
- **マイページ:**
    - プロフィール設定など、一般的なマイページ機能。
    - お気に入り登録したフィードバックの一覧を表示。

## 5. 技術要件

- **フロントエンド:** Next.js, React
- **バックエンド & データベース:** Supabase
- **AI:** OpenAI API (ChatGPT)
- **Webスクレイピング:** Playwright
- **プラットフォーム:** Webアプリケーション（モバイルファースト、レスポンシブ対応）

---

## ▼ プロジェクト方針

- **MVP（Minimum Viable Product）の範囲:**
    - 最初のリリースでは、以下のコア機能に集中する。
        - ユーザー認証
        - 日記の作成・閲覧・検索（リスト形式・カレンダー形式）
        - 全8キャラクターからのフィードバック機能（フィードバック詳細閲覧含む）
        - マイページ（お気に入りリスト機能は除く）
    - 以下の機能は、初回リリース後のアップデートで追加する。
        - キャラクターとの個別チャット機能
        - フィードバックのお気に入り登録機能

- **通知機能:**
    - フィードバック更新時のプッシュ通知やメール通知は、現時点では実装しない。

---

## ▼ 不明点・確認事項

ドラフトを作成する上で、いくつか確認したい点がございます。

1.  **MVP（Minimum Viable Product - 必要最低限の機能）の範囲について:**
    -   初回のリリースでは、どの機能から優先して実装するのが良いでしょうか？
    -   **提案A:** まずは「ユーザー認証」「日記の作成・閲覧」「キャラクター1体からのフィードバック」に絞って開発し、素早くリリースすることを目指す。
    -   **提案B:** 最初から全8キャラクターを実装するが、チャット機能やお気に入り機能は後のアップデートで追加する。
    -   ご希望の進め方はありますか？

2.  **時事ネタの取得元について:**
    -   Playwrightでスクレイピングする時事ネタは、特定のニュースサイトなどを想定されていますか？あるいは、一般的なニュースのヘッドラインを取得するイメージでしょうか？

3.  **通知機能について:**
    -   フィードバックが更新された際に、ユーザーに知らせるためのプッシュ通知やメール通知は必要でしょうか？

4.  **キャラクターの詳細について:**
    -   こちらは後ほどいただけるとのことですので、タスクを生成する際に、キャラクター設定用のタスクを含めておきます。

上記について、ご意見をお聞かせいただけますでしょうか。
いただいた回答を基に、このPRDを完成させ、具体的な開発タスクを生成していきます。 